@{
    ViewBag.Title = "我的约看";
    Layout = "~/views/shared/_layout.cshtml";
}
<div class="container">
    <div class="box_main">
        <div class="search_listheader" style="background:#fff">
            <div class="search_listheader_l" onclick="return history.go(-1);"><i class="iconfont icon-jiantou-copy1"></i></div>
            <h2> 我的约看</h2>
        </div>
        <div class="iprolist yixiang" style="padding-top: 34px;">
            <div class="iprolistc" id="tab1"></div>
        </div>
    </div>
</div>
<!--我的约看模板-->
<script id="MyBookingTemplate" type="text/html">
    {{#  layui.each(d, function(index, item){}}
    <div class="fangwu_box">
        <div class="yixiang_box_tit">约看时间：{{item.bookingTime}}</div>
        <dl>
            <div class="swipe_content">
                <dt>
                    <a href="/house/details/{{item.houseID}}"><img src="{{item.houseDetail.houseCorver==""?"/Content/img/ad1.png":item.houseDetail.houseCorver}}" onerror="this.onerror='';this.src='/Content/img/ad1.png'"></a>
                </dt>
                <dd>
                    <h3>
                        <a href="/house/details/{{item.houseID}}">{{item.houseDetail.houseTitle.substring(0,14)}}</a>&nbsp;<span>{{item.houseDetail.rentMode}}</span>
                    </h3>
                    <div class="iprolist_about">
                        <span>{{item.houseDetail.detailAddress}}</span>
                    </div>
                    <div class="iprolist_adress"><div class="iprolist_price"><em style="color:#333333">￥{{item.houseDetail.hRent}}</em>/月</div></div>
                </dd>
            </div>
            <div class="swipe_hidden"><a href="javascript:void(0);" onclick="DelHandler('{{item.orderNo}}');">删除</a></div>
        </dl>
        <div class="yixiang_box_tit">
            <a href="tel:{{item.leaseCustomerAccount}}">
                <span>
                    {{item.leaseCustomerName}}
                    {{# item.leaseCustomerAccount = $.formatMobile(item.leaseCustomerAccount)}}
                    {{ item.leaseCustomerAccount}}
                </span><em style="color:#FD7A20">联系租客</em>
            </a>
        </div>
    </div>
    {{#  }); }}

    {{#  if(d.length === 0){ }}
    无数据
    {{#  } }}
</script>
<script src="/Content/js/zepto.fx.js"></script>
<script src="/Content/js/swipe.min.js"></script>
<script type="text/javascript">
    $(function () {
        InitMyBooking();
    })
    //初始化我的约看
    function InitMyBooking() {
        $.LayPage({
            elem: '#tab1'
      , Template: '#MyBookingTemplate'
      , mb: 100
      , url: globalKey.InterfaceDomain + 'api/Users/MyLBookingList'
      , type: 'post'
      , data: { pagesize: 5, userId: $('#Uid').val() }//参数
        });
    }
    //删除
    function DelHandler(orderNo) {
        $.BottomDialog({
            content: '您确认要<span style="color:red;">删除</span>该预约吗?'
                  , callBack: function () {
                      $.ar({
                          url: globalKey.InterfaceDomain + 'api/booking/Del'
                         , data: { userId: $('#Uid').val(), orderNo: orderNo }
                         , success: function (data) {
                             $.modalMsg({
                                 content: data.msg, success: function () {
                                     window.location.href = "/Account/MyLBooking";
                                 }
                             });
                         }
                      });
                      return false;
                  }
        });
    }
</script>